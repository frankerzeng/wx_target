define(function(b){var a=b("now");!function(e){var c=function(i,h){this.options=h;this.$element=e(i).addClass(h.css);this._data=[];this._selected=null;this._style=g;this._init()};c.prototype={constructor:c,_init:function(){var j=this.options,h=typeof this.options.data,i=this;i._expandOption();switch(h){case"object":i._load(j.data);break;case"string":a.cmd(j.data,j.para,function(k){i._load(k)});break;default:return false;break}return true},_load:function(h){var i=this._analysis(h);if(i&&i.length>0){this.$element.html(i);this._eventBind()}else{return false}},_eventBind:function(){var i=this,h=i._style;e("ul li."+h.item.main,i.$element).on("mouseover",function(){e(this).addClass(h.item.hover)}).on("mouseout",function(){e(this).removeClass(h.item.hover)});e("ul li."+h.item.main+" a",i.$element).on("click",function(){i._event("select",parseInt(e(this).attr("data-index"),10))})},_analysis:function(k){var j=this,l="",i=j.options.map;l+="<ul>";var h=k[i.list.chapter];if(!j._isObjectEmpty(h)){e.each(h,function(n,m){l+=j._analysisChapter(m,n+1)})}l+="</ul>";return l},_analysisChapter:function(j,l){var p=this,m="",k=p._style,q=p.options.map,o=j[q.list.section],h=j[q.list.resource],i=j[q.list.exam],n=k.chapter.main;if(p._isObjectEmpty(o)){n=k.chapter.mixed}m+='<li class="'+k.theme.main+" "+n+'">';m+='   <div class="'+k.left+'">';m+="       <i>"+l+"</i>";m+="   </div>";m+='   <div class="'+k.right+'">';m+='       <span class="'+k.chapter.title+'">'+j[q.chapter.name]+"</span>";m+="   </div>";m+="</li>";if(!p._isObjectEmpty(o)){e.each(o,function(r,s){m+=p._analysisSection(s,r+1,j[q.chapter.id])})}else{if(!p._isObjectEmpty(h)){e.each(h,function(r,s){m+=p._analysisResource(s,j[q.chapter.id],"",j[q.chapter.courseId])})}if(!p._isObjectEmpty(i)){e.each(i,function(r,s){m+=p._analysisExam(s,j[q.chapter.id],"",j[q.chapter.courseId])})}}return m},_analysisSection:function(n,k,l){var o=this,m="",j=o._style,p=o.options.map,h=n[p.list.resource],i=n[p.list.exam];m+='<li class="'+j.theme.main+" "+j.section.main+'">';m+='   <div class="'+j.left+'">';m+="       <i>"+k+"</i>";m+="   </div>";m+='   <div class="'+j.right+'">';m+='       <span class="'+j.section.title+'">'+n[p.section.name]+"</span>";m+="   </div>";m+="</li>";if(!o._isObjectEmpty(h)){e.each(h,function(q,r){m+=o._analysisResource(r,l,n[p.section.id],n[p.section.courseId])})}if(!o._isObjectEmpty(i)){e.each(i,function(q,r){m+=o._analysisExam(r,l,n[p.section.id],n[p.section.courseId])})}return m},_analysisResource:function(m,l,k,o){var j=this,n="",i=j.options.map,h=m[i.resource.kindName];m[i.chapter.id]=l;m[i.chapter.courseId]=o;m[i.section.id]=k;switch(h){case"文本":n+=j._analysisLiterature(m);break;case"三分屏":n+=j._analysisVideo(m);break;default:n+=j._analysisVideo(m);break}return n},_analysisLiterature:function(m){var k=this,n="",j=k._style,i=k.options.map,h="",o="",l=parseInt(m[i.resource.percent],10);n+='<li class="'+j.item.main+" "+j.literature.main+'">';n+='    <div class="'+j.left+'">';if(l==100){h="full";o=j.studyButton.finish}else{if(l==0){h="empty";o=j.studyButton.unStart}else{h="half";o=j.studyButton.unFinish}}n+='        <i class="'+h+'"></i>';n+="    </div>";n+='    <div class="'+j.right+'">';n+='        <span class="'+j.literature.time+' right">'+k._toTime(parseInt(m[i.resource.time],10))+'<i class="'+j.literature.img+'"></i></span>';n+='        <a class="'+j.studyButton.main+' right res" data-index="'+k._getDataLength()+'" href="javascript:void(0);">'+o+"</a>";k._appendData(m);n+='        <span class="'+j.literature.title+'">'+m[i.resource.name]+"</span>";n+="    </div>";n+="</li>";return n},_analysisVideo:function(m){var k=this,n="",j=k._style,i=k.options.map,h="",o="",l=parseInt(m[i.resource.percent],10);n+='<li class="'+j.item.main+" "+j.video.main+'">';n+='    <div class="'+j.left+'">';if(l==100){h="full";o=j.studyButton.finish}else{if(l==0){h="empty";o=j.studyButton.unStart}else{h="half";o=j.studyButton.unFinish}}n+='        <i class="'+h+'"></i>';n+="    </div>";n+='    <div class="'+j.right+'">';n+='        <span class="'+j.video.time+' right">'+k._toTime(parseInt(m[i.resource.time],10))+'<i class="'+j.video.img+'"></i></span>';n+='        <a class="'+j.studyButton.main+' right res" data-index="'+k._getDataLength()+'" href="javascript:void(0);">'+o+"</a>";k._appendData(m);n+='        <span class="'+j.video.title+'">'+m[i.resource.name]+"</span>";n+="    </div>";n+="</li>";return n},_analysisExam:function(k,m,l,o){var j=this,n="",i=j._style,h=j.options.map;n+='<li class="'+i.item.main+" "+i.exam.main+'">';n+='    <div class="'+i.left+'"><i class="full"></i></div>';n+='    <div class="'+i.right+'">';n+='        <span class="'+i.exam.time+' right">'+k[h.exam.subNum]+'题<i class="'+i.exam.img+'"></i></span>';n+='        <a class="'+i.studyButton.main+' right exam" data-index="'+j._getDataLength()+'" href="javascript:void(0);" >'+i.studyButton.goExam+"</a>";k[h.chapter.id]=m;k[h.chapter.courseId]=o;k[h.section.id]=l;j._appendData(k);n+='        <span class="'+i.exam.title+'">'+k[h.exam.name]+"</span>";n+="    </div>";n+="</li>";return n},_reload:function(h){var i=this,j=this.options;if(!i._isObjectEmpty(h)){j=e.extend({},j,h)}i._expandOption();i._clearData();i._init()},_toTime:function(i){var h=parseInt(i/60,10);var j=parseInt(i%60,10);return(this._expandNum(h)+":"+this._expandNum(j))},_expandNum:function(h){var i="";if(h<10){i="0"+h}else{i=h+""}return i},_isObjectEmpty:function(i){if(typeof i=="object"&&i){for(var h in i){return false}return true}else{return true}},_expandOption:function(){var h=this,i=h.options;i.map=e.extend(true,f,i.map);i.map=e.extend(true,d,i.map)},_event:function(j,i){var h=this;h._selected=h._data[i];var k=e.Event(j);h.$element.trigger(k,h._selected)},_appendData:function(h){this._data.push(h)},_clearData:function(){this._data=[];this._data.length=0},_getDataLength:function(){return this._data.length},_getSelected:function(){return this._selected},getSelect:function(){return this._getSelected()},reload:function(h){this._reload(h)}};e.fn.courseslt=function(i,h){return this.each(function(){var m=e(this),l=m.data("courseslt"),k=(typeof i=="string");if(!l){var j=e.extend({},e.fn.courseslt.defaults,typeof i=="object"&&i);m.data("courseslt",(l=new c(this,j)))}else{if(!k){l.options=e.extend({},l.options,typeof i=="object"&&i);l._init()}}if(k){if(null!=h&&h!=undefined){return l[i](h)}else{return l[i]()}}})};e.fn.courseslt.defaults={data:null,para:{},css:"courslt",map:{}};var d={list:{chapter:"chapter_list",section:"section_list",resource:"res_list",exam:"exam_list"},chapter:{name:"chapter_name"},section:{name:"section_name"},resource:{name:"res_name",time:"res_ltime",kindName:"res_kind_name",percent:"percent"},exam:{name:"exam_name",subNum:"sub_num"}};var f={chapter:{id:"chapter_id",courseId:"course_id"},section:{id:"section_id",courseId:"course_id"}};var g={left:"cour-lf",right:"cour-rg",theme:{main:"cour-the"},chapter:{main:"cour-chap",title:"cour-title",mixed:"cour-chap-sec"},section:{main:"cour-sec",title:"cour-title"},literature:{main:"",title:"cour-title",time:"cour-times",img:"doc"},video:{main:"",title:"cour-title",time:"cour-times",img:"vod"},exam:{main:"",title:"cour-title",time:"cour-times",img:"tes"},item:{main:"cour-res",hover:"active"},studyButton:{unStart:"开始学习",unFinish:"继续学习",finish:"进入复习",goExam:"进入",main:"btn-primary"}}}(jQuery);!function(d){var c=function(f,e){this.data=0;this.$element=d(f).addClass(e.css);this.options=e;this.cutDownRender=null;this._init()};c.prototype={constructor:c,_init:function(){var e=this;e.data=this._analyTime(e.options.data);e._load()},_load:function(){var g=this,i=this.options,f=this.$element,e="",h=g._analyTime(g.data.toString());e+='<div class="timecnt-con">';if(i.showIcon){e+='<span class="icon"></span>'}e+='<span class="time text-info"></span><div class="clearboth"></div>';e+="</div>";f.html(e);g._setTime(g._parseTime(g.data));if(i.auto){g._start()}},_setTime:function(g){var f=this,h=f.options,e=f.$element;d(".time",e).html(h.hint+g)},_resetData:function(){this.data=0},_start:function(){var e=this,f=e.options;e.cutDownRender=setInterval(function(){if(e.data==0){e._submit();e._stop()}e._setTime(e._parseTime(e.data));e.data--},1000)},_stop:function(){var e=this;if(null!=e.cutDownRender){clearInterval(e.cutDownRender)}},_submit:function(){var e=this,f=e.options.submitRender;if(d.isFunction(f)){f()}e._stop();e._resetData()},_analyTime:function(g){var f=g.charAt(g.length-1),e=parseFloat(g,10);e=isNaN(e)?0:e;switch(f){case"s":return e;break;case"m":return e*60;break;case"h":return e*3600;break;default:return e*60;break}},_parseSecond:function(f){var g=f.split(":"),e=0;if(g&&g.length>0&&g.length<4){d.each(g,function(h,j){e+=60^(2-h)*parseInt(j,10)})}return e},_parseTime:function(j){if(isNaN(j)){return j}var g=this,i=parseInt(j,10),e=parseInt(i/60,10),h=parseInt(i%60,10),f=parseInt(e%60,10);_hour=parseInt(e/60,10);return(g._extendNum(_hour)+":"+g._extendNum(f)+":"+g._extendNum(h))},_extendNum:function(e){if(e>=0&&e<10){return"0"+e}else{return e+""}},_isNullOrEmpty:function(e){if(e&&e.length>0){return false}else{return true}},reload:function(e){var f=this,g=this.options;if(e&&typeof e=="object"){g=d.extend({},g,e)}f._init()},submit:function(){this._submit()},save:function(){var f=this,e=f.options.saveRender;f._stop();if(d.isFunction(e)){e()}},stop:function(){this._stop()},restart:function(){var e=this;e._stop();e._start()},getLastTime:function(g){var e=this,f=parseFloat(e.data);switch(g){case"m":return f/60;break;case"s":return f;break;case"h":return f/3600;break;default:return f/60;break}},start:function(){this._start()}};d.fn.timecnt=function(g,f,e){return this.each(function(){var k=d(this),j=k.data("timecnt"),i=(typeof g=="string");if(!j){var h=d.extend({},d.fn.timecnt.defaults,typeof g=="object"&&g);k.data("timecnt",(j=new c(this,h)))}else{if(!i){j.options=d.extend({},j.options,typeof g=="object"&&g);j.reload()}}if(i){if(d.isFunction(f)){f(j[g]({}))}else{if(d.isFunction(e)){e(j[g](f))}else{j[g](f)}}}})};d.fn.timecnt.defaults={css:"timecnt",data:"0",submitRender:null,saveRender:null,showIcon:true,hint:"剩余时间：",auto:false}}(jQuery);!function(c){var d=function(f,e){this.options=e;this.$element=c(f).addClass(e.css);this.data=null;this.selected=null;this._init()};d.prototype={constructor:"AnswerCard",_init:function(){var f=this,g=f.options,e=typeof g.data;switch(e){case"object":f.data=g.data;f._load();break;case"string":a.cmd(g.data,g.para,function(h){f.data=h;f._load()});break;default:break}},_load:function(){var g=this,l=g.options,f=g.$element,i=g.data,e="",k=l.hint,h=l.render,j=l.field;e+='<div class="answercard-con">';if(k&&k.length>0){e+='<p class="ans-tip">'+k+"</p>"}e+='<ul class="nav nav-pills ans-list">';c.each(i,function(n,o){var p="",m="";if(o[l.selected]){p="active"}if(o[j]){m='data-field="'+o[j]+'"'}e+="<li "+m+' class="'+p+'">';if(c.isFunction(h)){e+=h(n,o)}else{if(typeof h=="string"){e+='<a href="###" data-index="'+n+'">'+g._expandNum(o[h])+"</a>"}}e+="</li>"});e+="</ul>";e+="</div>";f.html(e);g._eventBind()},_setSelected:function(j){var e=this,g=e.data,i=e.options,h=i.field,f=i.selected;c(".ans-list li[data-field="+j+"]").addClass("active");c.each(g,function(k,l){if(l[h]==j){l[f]=true;e.selected=l;return false}})},_setunSelected:function(j){var e=this,g=e.data,i=e.options,h=i.field,f=i.selected;c(".ans-list li[data-field="+j+"]").removeClass("active");c.each(g,function(k,l){if(l[h]==j){l[f]=false;return false}})},_eventBind:function(){var f=this,e=f.$element,h=f.options,g=f.data;c(".ans-list a",e).on("click",function(i){var j=c(this).attr("data-index");f.selected=g[j];f._eventTrigger("select",j,f.selected)})},_eventTrigger:function(k,i,h,g,f){var j=this,l=c.Event(k);j.$element.trigger(l,[i,h,g,f])},_isArray:function(e){return Object.prototype.toString.call(e)==="[object Array]"},_expandNum:function(f){if(isNaN(f)){return f}var e=parseInt(f,10);if(e>=0&&e<10){return"0"+e}else{return f}},reload:function(e){var f=this,g=f.options;if(e&&typeof e=="object"){g=c.extend({},g,e)}f._init()},getSelecteds:function(){var e=this;return c.grep(e.data,function(g,f){if(g[e.options.selected]){return true}})},getunSelecteds:function(){var e=this;return c.grep(e.data,function(g,f){if(g[e.options.selected]){return true}},true)},getSelected:function(){return this.selected},setSelected:function(e){var f=this;if(f._isArray(e)){c.each(e,function(g,h){f._setSelected(h)})}else{f._setSelected(e)}},setunSelected:function(e){var f=this;if(f._isArray(e)){c.each(e,function(g,h){f._setunSelected(h)})}else{f._setunSelected(e)}}};c.fn.answercard=function(g,f,e){return this.each(function(){var k=c(this),j=k.data("answercard"),i=(typeof g=="string");if(!j){var h=c.extend({},c.fn.answercard.defaults,typeof g=="object"&&g);k.data("answercard",(j=new d(this,h)))}else{if(!i){j.options=c.extend({},j.options,typeof g=="object"&&g);j.reload()}}if(i){if(c.isFunction(f)){f(j[g]({}))}else{if(c.isFunction(e)){e(j[g](f))}else{j[g](f)}}}})};c.fn.answercard.defaults={css:"answercard",data:null,para:{},selected:"selected",field:"id",render:"sort",hint:"答题卡："}}(jQuery);!function(h){var i=function(m,l){this.options=l;this.$element=h(m).addClass(l.css);this.data=null;this.selected=null;this._init()};i.prototype={constructor:i,_init:function(){var m=this,n=this.options,l=typeof n.data;if(l=="object"){m.data=n.data;m._load()}else{if(l=="string"){a.cmd(n.data,n.para,function(o){m.data=o;m._load()})}}},_load:function(){var x=this,v=x.options,o=x.data,z=x.$element,q=v.type,r=null,s="",w=null,n=null,u=null,m=null,y=null,p=null,l="";if(o){o.sort(function(A,t){return parseInt(A[k.sort],10)-parseInt(t[k.sort],10)});w=h.grep(o,function(A,t){if(A[k.type]==d.singleChoice){return true}});n=h.grep(o,function(A,t){if(A[k.type]==d.multiChoice){return true}});u=h.grep(o,function(A,t){if(A[k.type]==d.judge){return true}});m=h.grep(o,function(A,t){if(A[k.type]==d.filling){return true}});y=h.grep(o,function(A,t){if(A[k.type]==d.shortAnswer){return true}});p=h.grep(o,function(A,t){if(A[k.type]==d.group){return true}});r={singleChoices:w,multiChoices:n,judges:u,fillings:m,shortAnswers:y,groups:p};s+='<div class="ques-con">';l="_analyBy"+x._toFirstUpperCase(q);if(h.isFunction(x[l])){s+=x[l](r)}s+="</div>";z.html(s);x._eventBind();x._eventLaunch()}},_analyBySin:function(){var o=this,r=o.options,l=0,n="",p=o.data,q="active";n+='<div class="sin">';n+='<div class="carousel slide" id="ques-sin">';n+='<ol class="carousel-indicators" style="display: none;">';for(var m=0;m<p.length;m++){if(m==0){q="active"}else{q=""}n+='<li data-target="#ques-sin" data-slide-to="'+m+'" class="'+q+'"></li>'}n+="</ol>";n+='<div class="carousel-inner">';h.each(p,function(s,t){if(s==0){q="active"}else{q=""}n+='<div class="item '+q+'">';n+=o._analyQues(t);n+="</div>"});n+="</div>";n+='<div class="btn-group sin-btns">';n+='<button class="btn sin-prev">上一题</button>';n+='<button class="btn sin-next">下一题</button>';n+='<button class="btn sin-first">首题</button>';n+='<button class="btn sin-last">末题</button>';n+="</div>";n+="</div>";n+="</div>";return n},_analyByAll:function(o){var v=this,q=v.options,s=0,p="",u=o.singleChoices,m=o.multiChoices,r=o.judges,l=o.fillings,w=o.shortAnswers,n=o.groups;p+='<div id="ques-all" class="all">';if(u.length>0){p+='<div class="all-sin">';p+='<div class="all-ti">';p+="<span>"+e.charAt(s)+"、 单选题</span>";p+="</div>";p+='<div class="all-con">';h.each(u,function(x,t){p+=v._analySin(t)});p+="</div>";p+="</div>";s++}if(m.length>0){p+='<div class="all-mul">';p+='<div class="all-ti">';p+="<span>"+e.charAt(s)+"、 多选题</span>";p+="</div>";p+='<div class="all-con">';h.each(m,function(t,x){p+=v._analyMul(x)});p+="</div>";p+="</div>";s++}if(r.length>0){p+='<div class="all-jud">';p+='<div class="all-ti">';p+="<span>"+e.charAt(s)+"、 判断题</span>";p+="</div>";p+='<div class="all-con">';h.each(r,function(t,x){p+=v._analyJud(x)});p+="</div>";p+="</div>";s++}if(l.length>0){p+='<div class="all-fil">';p+='<div class="all-ti">';p+="<span>"+e.charAt(s)+"、 填空题</span>";p+="</div>";p+='<div class="all-con">';h.each(l,function(x,t){p+=v._analyFil(t)});p+="</div>";p+="</div>";s++}if(w.length>0){p+='<div class="all-sho">';p+='<div class="all-ti">';p+="<span>"+e.charAt(s)+"、 简答题</span>";p+="</div>";p+='<div class="all-con">';h.each(w,function(t,x){p+=v._analySho(x)});p+="</div>";p+="</div>";s++}if(n.length>0){p+='<div class="all-gro">';p+='<div class="all-ti">';p+="<span>"+e.charAt(s)+"、 组合题</span>";p+="</div>";p+='<div class="all-con">';h.each(n,function(x,t){p+=v._analyGro(t)});p+="</div>";p+="</div>";s++}p+="</div>";return p},_analyByTab:function(p){var w=this,r=w.options,u=0,q="",v=p.singleChoices,m=p.multiChoices,s=p.judges,l=p.fillings,x=p.shortAnswers,n=p.groups,o="active";q+='<div class="tab">';q+='<ul class="nav nav-tabs" id="ques-tab">';if(v.length>0){q+='<li class="'+o+'"><a href="#tab-sin" data-toggle="tab">单选题</a></li>';o=""}if(m.length>0){q+='<li class="'+o+'"><a href="#tab-mul" data-toggle="tab">多选题</a></li>';o=""}if(s.length>0){q+='<li class="'+o+'"><a href="#tab-jud" data-toggle="tab">判断题</a></li>';o=""}if(l.length>0){q+='<li class="'+o+'"><a href="#tab-fil" data-toggle="tab">填空题</a></li>';o=""}if(x.length>0){q+='<li class="'+o+'"><a href="#tab-sho" data-toggle="tab">简答题</a></li>';o=""}if(n.length>0){q+='<li class="'+o+'"><a href="#tab-gro" data-toggle="tab">组合题</a></li>';o=""}q+="</ul>";o="active";q+='<div class="tab-content">';if(v.length>0){q+='<div class="tab-pane tab-sin '+o+'" id="tab-sin">';h.each(v,function(y,t){q+=w._analySin(t)});q+="</div>";o=""}if(m.length>0){q+='<div class="tab-pane tab-mul '+o+'" id="tab-mul">';h.each(m,function(t,y){q+=w._analyMul(y)});q+="</div>";o=""}if(s.length>0){q+='<div class="tab-pane tab-jud '+o+'" id="tab-jud">';h.each(s,function(t,y){q+=w._analyJud(y)});q+="</div>";o=""}if(l.length>0){q+='<div class="tab-pane tab-fil '+o+'" id="tab-fil">';h.each(l,function(y,t){q+=w._analyFil(t)});q+="</div>";o=""}if(x.length>0){q+='<div class="tab-pane tab-sho '+o+'" id="tab-sho">';h.each(x,function(t,y){q+=w._analySho(y)});q+="</div>";o=""}if(n.length>0){q+='<div class="tab-pane tab-gro '+o+'" id="tab-gro">';h.each(n,function(y,t){q+=w._analyGro(t)});q+="</div>";o=""}q+="</div>";q+="</div>";return q},_analyQues:function(o){var n=this,l=o[k.type],p="",m="";p="_analy"+n._toFirstUpperCase(l);if(h.isFunction(n[p])){m+=n[p](o)}return m},_analySin:function(v){var y=this,u=y.options,x=v[u.field],m=v[k.selectedAnswer],r=v[k.sort],o=j[u.choiceArr]||"",s="",n="";s+='<div id="ques-'+r+'" class="sin">';s+='<div class="ques">';s+='<div class="ti">';s+='<span class="sort">第'+r+"题</span>";s+="<span>"+v[k.title]+"</span>";s+="</div>";s+='<div class="ch">';s+="<ul>";h.each(v[k.answers],function(t,z){s+='<li class="'+o+'">'+g.charAt(t)+". "+z+" </li>"});s+="</ul>";s+="</div>";s+='<div class="clearboth"></div>';s+="</div>";s+='<div class="ans">';s+='<div class="ans-con">';s+="<span>选择答案:</span>";s+='<ul data-index="'+r+'">';for(var q=0;q<parseInt(v[k.anawerCount],10);q++){var l=g.charAt(q),p="",w="";if(!y._isNullOrEmpty(m)&&m==l){p="active";w='checked="checked"';n=m}s+='<li data-field="'+x+l+'" class="'+p+'">';s+='<label class="radio">';s+='<input data-index="'+r+'" class="se-ans" data-field="'+x+'" value="'+l+'" name="sin-'+x+'" type="radio" '+w+"/>"+l;s+="</label>";s+="</li>"}s+="</ul>";s+='<input type="hidden" class="fi-ans" data-field="'+x+'" value="'+n+'"/>';s+="</div>";s+='<div class="clearboth"></div>';s+="</div>";s+="</div>";return s},_analyMul:function(q){var y=this,v=y.options,x=q[v.field],m=q[k.selectedAnswer],o=j[v.choiceArr]||"",s=q[k.sort],u="",n="";u+='<div id="ques-'+s+'" class="mul">';u+='<div class="ques">';u+='<div class="ti">';u+='<span class="sort">第'+s+"题</span>";u+="<span>"+q[k.title]+"</span>";u+="</div>";u+='<div class="ch">';u+="<ul>";h.each(q[k.answers],function(t,z){u+='<li class="'+o+'">'+g.charAt(t)+". "+z+" </li>"});u+="</ul>";u+="</div>";u+='<div class="clearboth"></div>';u+="</div>";u+='<div class="ans">';u+='<div class="ans-con">';u+="<span>选择答案:</span>";u+='<ul data-index="'+s+'">';for(var r=0;r<parseInt(q[k.anawerCount],10);r++){var l=g.charAt(r),p="",w="";if(!y._isNullOrEmpty(m)&&m.indexOf(l)>=0){p="active";w='checked="checked"';n=m}u+='<li data-field="'+x+l+'" class="'+p+'">';u+='<label class="checkbox">';u+='<input data-index="'+s+'" class="se-ans" data-field="'+x+'" value="'+l+'" name="mul-'+x+'" type="checkbox" '+w+"/>"+l;u+="</label>";u+="</li>"}u+="</ul>";u+='<input type="hidden" class="fi-ans" data-field="'+x+'" value="'+n+'"/>';u+="</div>";u+='<div class="clearboth"></div>';u+="</div>";u+="</div>";return u},_analyJud:function(x){var w=this,s=w.options,v=x[s.field],m=x[k.selectedAnswer],q=x[k.sort],r="",n="";r+='<div id="ques-'+q+'" class="jud">';r+='<div class="ques">';r+='<div class="ti">';r+='<span class="sort">第'+q+"题</span>";r+="<span>"+x[k.title]+"</span>";r+="</div>";r+='<div class="clearboth"></div>';r+="</div>";r+='<div class="ans">';r+='<div class="ans-con">';r+="<span>选择答案:</span>";r+='<ul data-index="'+q+'">';for(var p=0;p<2;p++){var l=f.charAt(p),o="",u="";if(!w._isNullOrEmpty(m)&&m==l){o="active";u='checked="checked"';n=m}r+='<li data-field="'+v+l+'" class="'+o+'">';r+='<label class="radio">';r+='<input data-index="'+q+'" class="se-ans" data-field="'+v+'" value="'+l+'" name="jud-'+v+'" type="radio" '+u+"/>"+l;r+="</label>";r+="</li>"}r+="</ul>";r+='<input type="hidden" class="fi-ans" data-field="'+v+'" value="'+n+'"/>';r+="</div>";r+='<div class="clearboth"></div>';r+="</div>";r+="</div>";return r},_analyFil:function(l){var p=this,r=p.options,o=l[k.selectedAnswer],q=l[r.field],n=l[k.sort],m="";m+='<div id="ques-'+n+'" class="fil">';m+='<div class="ques">';m+='<div class="ti">';m+='<span class="sort">第'+n+"题</span>";m+="<span>"+l[k.title]+"</span>";m+="</div>";m+="</div>";m+='<div class="ans">';if(p._isNullOrEmpty(o)){o=""}if(r.isEditor){m+='<div class="fi-editor" style="width: 100%; height: 0px;" id="fil-'+q+'" data-field="'+q+'" value="'+o+'"></div>';m+='<textarea style="display:none;" class="fi-ans" data-field="'+q+'" name="fil-'+q+'">'+o+"</textarea>"}else{m+="<fieldset>";m+="<div>";m+='<textarea class="fi-ans" data-field="'+q+'" name="fil-'+q+'">'+o+"</textarea>";m+="</div>";m+="</fieldset>"}m+="</div>";m+="</div>";return m},_analySho:function(r){var o=this,q=o.options,n=r[k.selectedAnswer],m=r[k.sort],p=r[q.field],l="";l+='<div id="ques-'+m+'" class="sho">';l+='<div class="ques">';l+='<div class="ti">';l+='<span class="sort">第'+m+"题</span>";l+="<span>"+r[k.title]+"</span>";l+="</div>";l+="</div>";l+='<div class="ans">';if(o._isNullOrEmpty(n)){n=""}if(q.isEditor){l+='<div class="fi-editor" style="width: 100%; height: 0px;" id="sho-'+p+'" data-field="'+p+'" value="'+n+'"></div>';l+='<textarea style="display:none;" class="fi-ans" data-field="'+p+'" name="sho-'+p+'">'+n+"</textarea>"}else{l+="<fieldset>";l+="<div>";l+='<textarea class="fi-ans" data-field="'+p+'" name="sho-'+p+'">'+n+"</textarea>";l+="</div>";l+="</fieldset>"}l+="</div>";l+="</fieldset>";l+="</div>";l+="</div>";return l},_analyGro:function(l){var n=this,o=n.options,m="";m+='<div class="gro">';m+='<div class="ques">';m+='<div class="ti">';m+="<span>"+l[k.title]+"</span>";m+="</div>";m+='<div class="clearboth"></div>';m+="</div>";m+='<div class="">';h.each(l[k.answers],function(p,q){m+=n._analyQues(q)});m+="</div>";m+="</div>";return m},_eventBind:function(){var m=this,p=m.options,n=m.data,l=m.$element,o=m.selected;h(".ans .se-ans",l).on("change",function(s){var A=h(this),x=A.attr("type"),v=A.attr("data-field"),z=this.checked,q=h(".ans .fi-ans[data-field="+v+"]",l),t=q.val(),r=A.val(),y=A.attr("data-index"),u=h(".ans ul[data-index="+y+"] li"),w=h(".ans li[data-field="+v+r+"]");switch(x){case"radio":u.removeClass("active");if(z){w.addClass("active");q.val(r)}break;case"checkbox":if(z){if(t.indexOf(r)<0){w.addClass("active");q.val(t+r)}}else{w.removeClass("active");q.val(t.replace(r,""))}break;default:break}q.trigger("change")});h(".ans .fi-ans",l).on("change",function(t){var s=h(this),r=s.val(),q=s.attr("data-field");h.each(n,function(u,v){if(v[p.field]&&v[p.field]==q){v[k.selectedAnswer]=r;o=v;return false}});if(m._isNullOrEmpty(r)){m._eventTrigger("uncheck",o)}else{m._eventTrigger("check",o)}}).on("input",function(q){h(this).trigger("change")}).bind("propertychange",function(q){h(this).trigger("change")}).on("keyup",function(q){h(this).trigger("change")});if(p.type==c.single){h(".sin-prev",l).on("click",function(){h("#ques-sin",l).carousel("prev");h("#ques-sin",l).carousel("pause")});h(".sin-next",l).on("click",function(){h("#ques-sin",l).carousel("next");h("#ques-sin",l).carousel("pause")});h(".sin-first",l).on("click",function(){h("#ques-sin",l).carousel(0);h("#ques-sin",l).carousel("pause")});h(".sin-last",l).on("click",function(){h("#ques-sin",l).carousel(n.length-1);h("#ques-sin",l).carousel("pause")})}if(p.isEditor){h(".fi-editor",l).each(function(){var t=h(this),r=t.attr("value"),q=t.attr("data-field"),s=h(".fi-ans[data-field="+q+"]",l);setInterval(function(){var u=t.attr("value");if(u!=r){r=u;s.val(r);s.trigger("change")}},100)})}},_eventTrigger:function(q,o,n,m,l){var p=this,r=h.Event(q);p.$element.trigger(r,[o,n,m,l])},_eventLaunch:function(){var n=this,o=n.options,m=o.type,l=n.$element;if(m==c.tab){h("#ques-tab a:first",l).tab("show")}else{if(m==c.sin){h("#ques-sin",l).carousel({interval:false})}else{if(m==c.all){}}}if(o.isEditor){h(".fi-editor",l).each(function(){var q=h(this),p=q.attr("value");q.editor({data:p,isSync:true})})}},_toFirstUpperCase:function(m){var l=m.charAt(0);return l.toUpperCase()+m.substr(1)},_isNullOrEmpty:function(l){if(null==l||l.length<1){return true}return false},reload:function(l){var m=this,n=m.options;if(typeof l=="object"){n=h.extend({},n,l)}m._init()},getChecked:function(){return this.selected},getCheckeds:function(){var l=this;return h.grep(l.data,function(n,m){if(!l._isNullOrEmpty(n[k.selectedAnswer])){return true}})},getunCheckeds:function(){var l=this;return h.grep(l.data,function(n,m){if(l._isNullOrEmpty(n[k.selectedAnswer])){return true}})},position:function(p){var x=this,l=x.data,y=x.$element,r=x.options,u=h("div#ques-"+p,y),o=u.offset().top-200,v=0,w=0,q=0,n=0,s=0,m="";p=parseInt(p,10);if(r.type==c.tab){v=h.grep(l,function(z,t){if(z[k.type]==d.singleChoice){return true}}).length;if(p<=v){m="sin"}else{w=h.grep(l,function(z,t){if(z[k.type]==d.multiChoice){return true}}).length;if(p<=v+w){m="mul"}else{q=h.grep(l,function(z,t){if(z[k.type]==d.judge){return true}}).length;if(p<=v+w+q){m="jud"}else{n=h.grep(l,function(z,t){if(z[k.type]==d.filling){return true}}).length;if(p<=v+w+q+n){m="fil"}else{s=h.grep(l,function(z,t){if(z[k.type]==d.shortAnswer){return true}}).length;if(p<=v+w+q+n+s){m="sho"}else{m="gro"}}}}}h('#ques-tab a[href="#tab-'+m+'"]').tab("show");h("html,body").animate({scrollTop:o},0)}else{if(r.type==c.all){h("html,body").animate({scrollTop:o},0)}else{if(r.type==c.single){h("#ques-sin",y).carousel(p);h("#ques-sin",y).carousel("pause")}}}}};h.fn.quesmdl=function(n,m,l){return this.each(function(){var r=h(this),q=r.data("quesmdl"),p=(typeof n=="string");if(!q){var o=h.extend({},h.fn.quesmdl.defaults,typeof n=="object"&&n);r.data("quesmdl",(q=new i(this,o)))}else{if(!p){q.options=h.extend({},q.options,typeof n=="object"&&n);q.reload()}}if(p){if(h.isFunction(m)){m(q[n]({}))}else{if(h.isFunction(l)){l(q[n](m))}else{q[n](m)}}}})};h.fn.quesmdl.defaults={css:"quesmdl",para:null,type:"tab",data:null,field:"sub_id",isEditor:false,choiceArr:"full"};var c={tab:"tab",all:"all",single:"sin"};var d={singleChoice:"sin",multiChoice:"mul",judge:"jud",filling:"fil",shortAnswer:"sho",group:"gro"};var k={type:"kind",score:"sub_score",sort:"sub_sort",title:"sub_content",answers:"items",anawerCount:"answer_count",selectedAnswer:"stu_answer"};var j={full:"full-line",half:"half-line",auto:"auto"};var g="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var f="对错";var e="一二三四五六七八九"}(jQuery);!function(d){var c=function(g,f){this.options=f;this.$element=d(g).addClass(f.css);this.data=null;this.selected=null;this.$testobjs={};this.submitFun=null;this.saveFun=null;this.timeSync=null;this._init()};c.prototype={constructor:c,_init:function(){var g=this,h=g.options,f=typeof h.data;if(f=="object"){g.data=h.data;g._load()}else{if(f=="string"){a.cmd(h.data,h.para,function(i){g.data=i;g._load()})}}},_load:function(){var p=this,g=p.data,i=p.options,q=p.$element,o=i.submitRender,f=i.saveRender,m=e.test,l=e.student,k=e.question,n=g[m.questions],j=g[m.student],h="";h+='<div class="test-con container">';h+="<!-- head !-->";h+='<div class="test-head">';h+="<!-- 考试 标题 -->";h+='<div class="test-ti text-info margin-bottom20">';h+="<h2>"+g[m.name]+"</h2>";h+="</div>";if(i.showSta&&!p._isNullOrEmpty(g[m.statement])){h+="<!-- 考试说明 !-->";h+='<div class="margin-bottom20">';h+='<span class="font-bold">考试说明&nbsp;&nbsp;</span>';h+="<span>"+g[m.statement]+"</span>";h+="</div>"}if(i.showStu||i.isTime||null!=i.infoRender){h+="<!-- 其他信息 !-->";h+='<div class="margin-bottom20">';if(i.showStu&&j){h+="<!-- 考生信息 !-->";h+='<div class="stu-info left-zone">';h+="<span>考生："+j[l.name]+"</span>";h+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";h+="<span>考生号："+j[l.number]+"</span>";h+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";h+="<span>证件号："+j[l.id]+"</span>";h+="</div>"}if(i.isTime){h+="<!-- 时间及其他信息 !-->";h+='<div id="test-time" class="right-zone">';h+="</div>"}if(null!=i.infoRender){h+="<!-- infoRender !-->";h+="<div>";if(typeof i.infoRender=="string"){h+=i.infoRender}else{if(d.isFunction(i.infoRender)){h+=i.infoRender(g)}}h+="</div>"}h+='<div class="clearboth"></div>';h+="</div>"}h+="</div>";h+="<!-- body !-->";h+='<div class="test-body">';h+="<!-- 考题区域 !-->";h+='<div id="test-ques" class="left-zone"></div>';h+="<!-- 答案区域 !-->";h+='<div class="right-zone" id="test-ans-zone">';h+='<div id="test-ans"></div>';h+='<div class="submit-con">';if(i.showSave){h+='<button class="btn test-save">保存</button>'}h+='<button class="btn btn-info test-submit">交卷</button>';h+="</div>";h+="</div>";h+='<div class="clearboth"></div>';h+="</div>";h+="</div>";h+="</div>";h+="</div>";q.html(h);this.$testobjs={time:d("#test-time",q),ques:d("#test-ques",q),ans:d("#test-ans",q)};if(null!=o){if(d.isFunction(o)){p.submitFun=function(){if(null!=p.timeSync){clearInterval(p.timeSync)}o(g)}}else{if(typeof o=="string"){p.submitFun=function(){if(null!=p.timeSync){clearInterval(p.timeSync)}a.cmd(o,g,function(r){})}}}}else{p.submitFun=function(){if(null!=p.timeSync){clearInterval(p.timeSync)}}}if(null!=f){if(d.isFunction(f)){p.saveFun=function(){if(null!=p.timeSync){clearInterval(p.timeSync)}f(g)}}else{if(typeof f=="string"){p.saveFun=function(){if(null!=p.timeSync){clearInterval(p.timeSync)}a.cmd(f,g,function(r){})}}}}else{p.saveFun=function(){if(null!=p.timeSync){clearInterval(p.timeSync)}}}p._eventLaunch();p._eventBind()},_eventBind:function(){var q=this,r=q.$element,i=q.$testobjs,l=e.question,k=q.options,m=k.questionField,g=q.data,j=i.ans,n=i.ques,f=i.time,h=f.offset().top,p=null,o=null;d(".test-save",r).on("click",function(){f.timecnt("save")});d(".test-submit",r).on("click",function(){f.timecnt("submit")});j.on("select",function(u,s,t){n.quesmdl("position",t[l.sort])});n.on("check",function(t,s){j.answercard("setSelected",s[m])});n.on("uncheck",function(t,s){j.answercard("setunSelected",s[m])});p=function(t,s){var u=t.offset().left;t.css({position:"fixed",top:(s>0?s:0)+"px",left:u+"px"})};o=function(s){s.css({position:"static"})};d(window).on("scroll",function(){var s=d(document).scrollTop(),t=r.offset().top+r.height()-300;if(s>=h&&s<=t){p(f,50);p(d("#test-ans-zone",r),108)}else{o(f);o(d("#test-ans-zone",r))}});q._eventInterval()},_eventTrigger:function(k,i,h,g,f){var j=this,l=d.Event(k);j.$element.trigger(l,[i,h,g,f])},_eventLaunch:function(){var n=this,i=n.options,g=n.data,h=n.$testobjs,m=e.test,j=e.question,k=i.questionField,o=g[m.questions],f=[],l={};h.ques.quesmdl({css:i.quesCss,type:i.type,data:o,field:k,isEditor:i.isEditor,choiceArr:i.choiceArr});d.each(o,function(p,q){l={selected:!n._isNullOrEmpty(q[j.selectedAnswer])};l[j.sort]=q[j.sort];l[k]=q[k];f.push(l)});h.ans.answercard({css:i.ansCss,data:f,field:k,render:j.sort});if(i.isTime){h.time.timecnt({css:i.timeCss,data:g[m.time],auto:i.auto,submitRender:n.submitFun,saveRender:n.saveFun})}},_eventInterval:function(){var g=this,i=g.data,j=g.options,h=g.$testobjs,f=h.time;if(j.isTime){g.timeSync=setInterval(function(){f.timecnt("getLastTime","m",function(k){i[e.test.time]=k})},1000)}},_isNullOrEmpty:function(f){if(null==f||undefined==f||f.length<1){return true}else{return false}},reload:function(f){var g=this,h=g.options;if(f&&typeof f=="object"){h=d.extend({},h,f)}g._init()},getSelected:function(){return this.selected},save:function(){var f=this,g=f.$testobjs;g.time.timecnt("save")},submit:function(){var f=this,g=f.$testobjs;g.time.timecnt("submit")},stop:function(){var f=this,g=f.$testobjs;if(f.timeSync){clearInterval(f.timeSync)}g.time.timecnt("stop")},getSelecteds:function(){var f=this.$testobjs;return f.ques.quesmdl("getSelecteds")},getunSelecteds:function(){var f=this.$testobjs;return f.ques.quesmdl("getunSelecteds")},getData:function(){return this.data},start:function(){var f=this,g=f.$testobjs;f._eventInterval();g.time.timecnt("start")}};d.fn.testmdl=function(h,g,f){return this.each(function(){var l=d(this),k=l.data("testmdl"),j=(typeof h=="string");if(!k){var i=d.extend({},d.fn.testmdl.defaults,typeof h=="object"&&h);l.data("testmdl",(k=new c(this,i)))}else{if(!j){k.options=d.extend({},k.options,typeof h=="object"&&h);k.reload()}}if(j){if(d.isFunction(g)){g(k[h]({}))}else{if(d.isFunction(f)){f(k[h](g))}else{k[h](g)}}}})};d.fn.testmdl.defaults={css:"testmdl",quesCss:"quesmdl",timeCss:"timecnt",ansCss:"answercard",type:"tab",data:null,para:null,saveRender:null,submitRender:null,showSave:true,showSta:true,showStu:true,isTime:true,isEditor:false,questionField:"sub_id",auto:true,infoRender:null,choiceArr:"full"};var e={test:{name:"te_name",statement:"te_stam",time:"te_time",questions:"subs_total",student:"subs_stu"},student:{name:"stu_name",number:"stu_num",id:"stu_id"},question:{type:"kind",score:"sub_score",sort:"sub_sort",title:"sub_content",answers:"items",anawerCount:"answer_count",selectedAnswer:"stu_answer"}}}(jQuery)});