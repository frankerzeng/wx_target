!function(c){var b=function(){this._init();this.code=[];this.isStart=false;this.isQuickMode=true};b.prototype={constructor:b,_init:function(){var e=this;c(document).on("click","a",function(){if(e.isStart&&e._notInExclude(c(this))){var f=e.isQuickMode?e._getQuickFormId(c(this)):"";if(f!==""){return}e._click(c(this))}}).on("click","button",function(){if(e.isStart&&e._notInExclude(c(this))){var f=e.isQuickMode?e._getQuickFormId(c(this)):"";if(f!==""){e._setQuickForm(f)}else{e._click(c(this))}}}).on("blur","input",function(){if(e.isStart&&e._notInExclude(c(this))){var f=e.isQuickMode?e._getQuickFormId(c(this)):"";if(f!==""){return}e._fill(c(this))}}).on("blur","textarea",function(){if(e.isStart&&e._notInExclude(c(this))){var f=e.isQuickMode?e._getQuickFormId(c(this)):"";if(f!==""){return}e._fill(c(this))}}).on("change","select",function(){if(e.isStart&&e._notInExclude(c(this))){var f=e.isQuickMode?e._getQuickFormId(c(this)):"";if(f!==""){return}e._sel(c(this))}}).on("select",".nui-drop",function(){if(e.isStart&&e._notInExclude(c(this))){var f=e.isQuickMode?e._getQuickFormId(c(this)):"";if(f!==""){return}e._nuiDrop(c(this))}})},start:function(){this.isStart=true;this.code=[];c("#testOuput").html("")},stop:function(){this.isStart=false},down:function(e,f){},_getParentId:function(e){var f=e.parent();while(f.length>0&&f.attr("id")===undefined){f=f.parent()}return f.attr("id")},_click:function(h){var f=this,i=h.attr("id"),e=h.text(),g=h.attr("name");if(i!==undefined&&i.indexOf("__")===false){f._appendCode("self.click('#"+i+"')    # 点击"+e)}else{if(e!==""){f._appendCode("self.click_text('#"+f._getParentId(h)+"', '"+e+"')    # 点击"+e)}else{if(g!==""){f._appendCode("self.click('#"+f._getParentId(h)+' [name="'+g+"\"]')    # 点击"+e)}else{f._appendCode("self.click('#"+f._getParentId(h)+" 未找到')    # 点击")}}}},_fill:function(i){var e=this,k=i.attr("id"),h=i.attr("type"),g=i.attr("name"),j=i.val();if(h==="radio"){e._appendCode("self.click('input[name=\""+g+'"][value="'+j+"\"]')    # 点击单选按钮"+g);return}else{if(h==="submit"||h==="checkbox"){e._click(i);return}}if(i.hasClass("nui-date")){e._appendCode("#输入日期控件，TODO日期不一定正确");var f=c("#_nui_datepick .day .active");j=f.attr("ym")+f.text()}if(k!==undefined&&k.indexOf("__")===false){e._appendCode("self.set_val('#"+k+"', '"+j+"')    # 填写文本框"+g)}else{e._appendCode("self.set_val('#"+e._getParentId(i)+' [name="'+g+"\"]', '"+j+"')    # 填写文本框"+g)}},_sel:function(h){var f=this,j=h.attr("id"),g=h.attr("name"),i=h.val(),e=h.find("option[value="+i+"]").text();if(j!==undefined&&j.indexOf("__")===false){f._appendCode("self.select_text('#"+j+"', '"+e+"')    # 选择下拉框"+g)}else{f._appendCode("self.select_text('#"+f._getParentId(h)+' [name="'+g+"\"]', '"+e+"')    # 选择下拉框"+g)}},_nuiDrop:function(g){var f=this,i=g.attr("id"),h=g.find(".dropdown-toggle input").val(),e=g.find(".dropdown-toggle a").text();f._appendCode("self.click('#"+i+" .dropdown-menu li[id="+h+"]')    # 填写下拉框"+e)},_notInExclude:function(f){var g=f.attr("id"),e="testStart,testStop,testCode,testIsQuick,testShow,testFuncName,testFuncDesc,testDownBtn,testDownLink,";if(e.indexOf(g+",")!==-1){return false}else{return true}},_getQuickFormId:function(e){var f=e.parent();while(f.length>0&&!f.hasClass("nui-quickform")){f=f.parent()}return f.hasClass("nui-quickform")?f.attr("id"):""},_setQuickForm:function(f){var e=this;c("#"+f).frm("val",function(g){if(g[0]){e._appendCode("check(self.val_frm('"+f+"', '', "+JSON.stringify(g[1])+"), 'eql', True)    # 填写表单"+f);e._appendCode("#check(self.click_and_get_errmsg('#"+f+" [type=submit]'), 'eql', '消息')");e._appendCode("#check(self.click_and_get_okmsg('#"+f+" [type=submit]'), 'eql', '消息')");e._appendCode("#self.find_text('#表单ID', '要查找的值')")}else{e._appendCode("check(self.val_frm('"+f+"', '', "+JSON.stringify(g[1])+"), 'eql', False)    # 填写表单"+f)}})},_appendCode:function(e){this.code.push(e);c("#testOuput").append("&nbsp;&nbsp;&nbsp;&nbsp;"+e+"\r\n\n");console.log(e)}};var a='<div id="_uitest_mask" class="" style="position: absolute;left: 0px;top:0px;background-color: red;z-index: 99999;">';a+='<button id="testStart" class="btn btn-primary">开始</button>&nbsp;&nbsp;&nbsp;<button id="testStop" class="btn">停止</button>&nbsp;&nbsp;&nbsp;';a+='<input id="testIsQuick" type="checkbox" checked/>表单模式&nbsp;&nbsp;&nbsp;<input id="testCode" type="checkbox"/>显示代码';a+='<div id="testShow" style="width:500px;height:400px;display:none;background-color: yellow"><br/><textarea id="testOuput" style="width:480px;height:320px;overflow:scroll;"></textarea>';a+='<div>用例名称：<input id="testFuncName" type="text" style="width:100px;" value="test"/>&nbsp;&nbsp;';a+='用例描述：<input id="testFuncDesc" type="text" style="width:150px;" value="注释"/>&nbsp;&nbsp;';a+='<a id="testDownBtn" class="btn" href="javascript:;">生成</a><a id="testDownLink" download="test.py" href="data:text/plain," class="">下载</a></div>';a+="</div>";a+="</div>";c("body").append(a);var d=new b();c("#testStart").click(function(){c(this).removeClass("btn-primary");c("#testStop").addClass("btn-primary");c("#testCode").removeClass("btn-primary");d.start()});c("#testStop").click(function(){c(this).removeClass("btn-primary");c("#testStart").addClass("btn-primary");c("#testCode").addClass("btn-primary");d.stop()});c("#testCode").click(function(){if(c(this).is(":checked")){c("#testShow").show()}else{c("#testShow").hide()}});c("#testIsQuick").click(function(){d.isQuickMode=c("#testIsQuick").is(":checked")});c("#testDownBtn").click(function(){var h=c("#testFuncName").val(),j=c("#testFuncDesc").val(),g="";if(h===""){h="test"}if(j===""){j="注释"}g="def "+h+":    # "+j+String.fromCharCode(13,10);for(var f=0;f<d.code.length;f++){g+="    "+d.code[f]+String.fromCharCode(13,10)}var e=new Blob([g]);c("#testDownLink").attr("download",h+".py");c("#testDownLink").attr("href",URL.createObjectURL(e))})}(jQuery);